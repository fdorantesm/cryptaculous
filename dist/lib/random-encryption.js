"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RandomEncryption=void 0;const crypto=require("crypto"),encryption_factory_1=require("./factories/encryption.factory"),aes_consts_1=require("./strategies/symmetric/aes/aes.consts");class RandomEncryption{static encrypt(t,r){const e=aes_consts_1.AES_ALGORITHM_MAP[t],o=crypto.randomBytes(Math.ceil(e.keyLength/2)).toString("hex"),n=crypto.randomBytes(Math.ceil(e.ivLength/2)).toString("hex");return{payload:encryption_factory_1.EncryptionFactory.createEncryption(t,{key:o,iv:n}).encrypt(r),algorithm:t,key:o,iv:n}}static decrypt(t){const{algorithm:r,key:e,iv:o,payload:n}=t;return encryption_factory_1.EncryptionFactory.createEncryption(r,{key:e,iv:o}).decrypt(n)}}exports.RandomEncryption=RandomEncryption;